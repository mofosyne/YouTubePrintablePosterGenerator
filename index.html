<!-- Brian Khuu 2024 -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Video Printable Poster Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f9f9f9;
            margin: 0;
        }
        #container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #controls {
            margin-bottom: 20px;
        }
        #poster {
            display: none;
            flex-direction: column;
            align-items: center;
            border: 2px solid #000;
            border-radius: 15px;
            padding: 20px;
            background-color: #fff;
            width: 140mm;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        #poster img {
            max-width: 100%;
        }
        #poster img .thumbnail {
            width: 100%;
        }
        #poster img .qrcode {
            max-width: 100%;
            image-rendering: pixelated;
        }
        #poster h2 {
            text-align: center;
            margin: 10px 0;
        }
        #author {
            text-align: center;
            margin-bottom: 20px;
        }
        #qrlink {
            text-align: center;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        #github-link {
            margin-top: 20px;
            font-size: 14px;
            color: #007bff;
        }
        #github-link a {
            text-decoration: none;
            color: #007bff;
        }
        #github-link a:hover {
            text-decoration: underline;
        }
        @media print {
            body * {
                visibility: hidden;
            }
            #poster, #poster * {
                visibility: visible;
            }
            #poster {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                margin: auto;
            }
        }
    </style>
</head>
<body>

    <div id="container">
        <h1>YouTube Video Printable Poster Generator</h1>

        <div id="controls">
            <input type="text" id="youtubeUrl" placeholder="Enter YouTube URL">
            <button onclick="generatePoster()">Generate Poster</button>
            <button id="print-button" onclick="window.print()" disabled>Print Poster</button>
        </div>
        
        <div id="poster">
            <img id="thumbnail" src="" alt="Thumbnail">
            <h2 id="title"></h2>
            <div id="author"></div>
            <div id="qrcode"></div>
            <div id="qrlink"></div>
        </div>

        <div id="github-link">
            <p><a href="https://github.com/mofosyne/YouTubePrintablePosterGenerator/" target="_blank">Want to help improve this page? Click to visit this GitHub repository!</a>.</p>
        </div>
    </div>

    <script src="https://davidshimjs.github.io/qrcodejs/qrcode.min.js"></script>
    <script>
        async function fetchVideoDetails(url) {
            if (url == "") {
                throw new Error('Url missing');
            }
            const apiUrl = `https://www.youtube.com/oembed?url=${encodeURIComponent(url)}&format=json`;
            const response = await fetch(apiUrl);
            if (!response.ok) {
                throw new Error('Failed to fetch video details');
            }
            return response.json();
        }

        function generateQRCode(url, pixel_size) {
            const qrCodeContainer = document.getElementById('qrcode');
            qrCodeContainer.innerHTML = '';
            new QRCode(qrCodeContainer, {
                text: url,
                width: pixel_size,
                height: pixel_size,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.M
            });
        }

        async function generatePoster() {
            const youtubeUrl = document.getElementById('youtubeUrl').value;
            try {
                const videoDetails = await fetchVideoDetails(youtubeUrl);
                document.getElementById('thumbnail').src = videoDetails.thumbnail_url;
                document.getElementById('title').textContent = videoDetails.title;
                document.getElementById('author').innerHTML = `by <a href="${videoDetails.author_url}" target="_blank">${videoDetails.author_name}</a>`;
                generateQRCode(youtubeUrl, videoDetails.thumbnail_height/2);
                document.getElementById('qrlink').textContent = youtubeUrl;
                document.getElementById('poster').style.display = 'flex';
                document.getElementById('print-button').disabled = false;
            } catch (error) {
                alert('Error generating poster: ' + error.message);
            }
        }
    </script>
</body>
</html>
